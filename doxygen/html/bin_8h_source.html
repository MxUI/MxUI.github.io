<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Multiscale Universal Interface: bin.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MUI_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multiscale Universal Interface
   </div>
   <div id="projectbrief">A Concurrent Framework for Coupling Heterogeneous Solvers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('bin_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">bin.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="bin_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">* Multiscale Universal Interface Code Coupling Library                       *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">* Copyright (C) 2019 Y. H. Tang, S. Kudo, X. Bian, Z. Li, G. E. Karniadakis  *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">* This software is jointly licensed under the Apache License, Version 2.0    *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">* and the GNU General Public License version 3, you may use it according     *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">* to either.                                                                 *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">* ** Apache License, version 2.0 **                                          *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);            *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">* you may not use this file except in compliance with the License.           *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">* You may obtain a copy of the License at                                    *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">* http://www.apache.org/licenses/LICENSE-2.0                                 *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">* Unless required by applicable law or agreed to in writing, software        *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,          *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">* See the License for the specific language governing permissions and        *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">* limitations under the License.                                             *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">* ** GNU General Public License, version 3 **                                *</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">* This program is free software: you can redistribute it and/or modify       *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">* it under the terms of the GNU General Public License as published by       *</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">* the Free Software Foundation, either version 3 of the License, or          *</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">* (at your option) any later version.                                        *</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">* This program is distributed in the hope that it will be useful,            *</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">* but WITHOUT ANY WARRANTY; without even the implied warranty of             *</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the              *</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">* GNU General Public License for more details.                               *</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">*                                                                            *</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">* You should have received a copy of the GNU General Public License          *</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">* along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.      *</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifndef BIN_H</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#define BIN_H</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="geometry_8h.html">geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">config.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespacemui.html">   54</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemui.html">mui</a> {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> INT&gt;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">struct </span>count_iterator : std::iterator&lt;std::random_access_iterator_tag,INT,INT,INT,INT&amp;&gt;{</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">   59</a></span>&#160;    INT <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    count_iterator() {}</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    count_iterator(<span class="keyword">const</span> count_iterator&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    count_iterator( INT cur ): <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>(cur) {}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    count_iterator&amp; operator++(){</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        ++<a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    count_iterator&amp; operator--(){</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        --<a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    count_iterator operator++(<span class="keywordtype">int</span>){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        count_iterator ret = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        operator++();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    count_iterator operator--(<span class="keywordtype">int</span>){</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        count_iterator ret = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        operator--();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    count_iterator  <a class="code" href="namespacemui.html#a8f282990f9dab2d809dc062d6142e212">operator+</a>(INT n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> count_iterator(<a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>+n); }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    count_iterator&amp; operator+=(INT n) { <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a> +=n; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    count_iterator  <a class="code" href="namespacemui.html#a6abe0b4248d7b1594551ff4f6ddda20a">operator-</a>(INT n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> count_iterator(<a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>-n); }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    count_iterator&amp; <a class="code" href="namespacemui.html#a6abe0b4248d7b1594551ff4f6ddda20a">operator-</a>(INT n) { <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a> -= n; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    INT <a class="code" href="namespacemui.html#a6abe0b4248d7b1594551ff4f6ddda20a">operator-</a>(count_iterator&amp;rhs)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>-rhs.cur_; }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    INT&amp; <a class="code" href="namespacemui.html#ab78e75f496c4d793c673081f344d5fc6">operator*</a>() { <span class="keywordflow">return</span> <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>; }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">const</span> INT&amp; <a class="code" href="namespacemui.html#ab78e75f496c4d793c673081f344d5fc6">operator*</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a>; }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">bool</span> operator!=( count_iterator rhs )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a> != rhs.cur_;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">bool</span> operator==( count_iterator rhs )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> !operator!=(rhs);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;};</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> INT&gt;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;count_iterator&lt;INT&gt;  <a class="code" href="namespacemui.html#a8f282990f9dab2d809dc062d6142e212">operator+</a>(INT n, count_iterator&lt;INT&gt; rhs) { <span class="keywordflow">return</span> count_iterator&lt;INT&gt;(rhs.cur_+n); }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">int</span> depth&gt; <span class="keyword">struct </span>set_map_{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespacemui.html#af94c98a0248d6923c8681b4d2c39df6e">apply</a>( <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span> lda[], <span class="keywordtype">int</span> lh[][2],</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                       <span class="keyword">const</span> std::vector&lt;std::size_t&gt;&amp; displs, std::vector&lt;std::size_t&gt;&amp; map ) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=lh[depth][0]; i&lt;lh[depth][1]; ++i )</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="namespacemui.html#af94c98a0248d6923c8681b4d2c39df6e">set_map_&lt;depth-1&gt;::apply</a>( offset+i*lda[depth], lda, lh, displs, map );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;};</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span>set_map_&lt;0&gt;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespacemui.html#af94c98a0248d6923c8681b4d2c39df6e">apply</a>( <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span>[] , <span class="keywordtype">int</span> lh[][2],</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                       <span class="keyword">const</span> std::vector&lt;std::size_t&gt;&amp; displs, std::vector&lt;std::size_t&gt;&amp; map ) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">typedef</span> count_iterator&lt;std::size_t&gt; iter;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        map.insert(map.end(), iter(displs[offset+lh[0][0]]), iter(displs[offset+lh[0][1]]));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;};</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html">  118</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmui_1_1bin__range.html">bin_range</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html">  121</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a> : std::iterator&lt;std::forward_iterator_tag,std::pair&lt;typename CONFIG::point_type,T&gt; &gt; {</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">  122</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">P</a> = std::pair&lt;typename CONFIG::point_type,T&gt;;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#acb6d849efa422c9c07a5866c3031a3f8">  123</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmui_1_1bin__iterator.html#acb6d849efa422c9c07a5866c3031a3f8">D</a> = CONFIG::D;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="structmui_1_1bin__iterator.html#ad4a934e39ea52abb9b9df227826e784b">bin_iterator</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__range.html">bin_range&lt;T,CONFIG&gt;</a>&amp; range_ );</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a28e68216dd247d68b9c60f99c13631c5">  125</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="structmui_1_1bin__iterator.html#a28e68216dd247d68b9c60f99c13631c5">bin_iterator</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__range.html">bin_range&lt;T,CONFIG&gt;</a>&amp; range_, <span class="keywordtype">int</span>) : <a class="code" href="structmui_1_1bin__iterator.html#a371e739fe4b63c447a787572eb8ed055">range</a>(range_) { <a class="code" href="structmui_1_1bin__iterator.html#a9dd12ec01e52a6aac8a2aa511b4a0849">invalidate</a>(); }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="structmui_1_1bin__iterator.html#ad4a934e39ea52abb9b9df227826e784b">bin_iterator</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a>&amp; ) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a>&amp; <a class="code" href="structmui_1_1bin__iterator.html#a4d77cf5d472236ac4d8a35bb97d70011">operator=</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a>&amp; ) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">inline</span> <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a>&amp; <a class="code" href="structmui_1_1bin__iterator.html#abcbb2de1b131606af75b303f2d8e90e9">operator++</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a348e1d15c037b9e1302f16dc065928fb">  130</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a> <a class="code" href="structmui_1_1bin__iterator.html#a348e1d15c037b9e1302f16dc065928fb">operator++</a>( <span class="keywordtype">int</span> ){</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a> other = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        this-&gt;<a class="code" href="structmui_1_1bin__iterator.html#abcbb2de1b131606af75b303f2d8e90e9">operator++</a>();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">return</span> other;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structmui_1_1bin__iterator.html#a9dd12ec01e52a6aac8a2aa511b4a0849">invalidate</a>();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structmui_1_1bin__iterator.html#add20c0285e60fb2bd9e7b82bb9fb4204">validate</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#abb2f0a6ce3579fa7f33409da0b295ea1">  138</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="structmui_1_1bin__iterator.html#abb2f0a6ce3579fa7f33409da0b295ea1">operator!=</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a>&amp; rhs )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structmui_1_1bin__iterator.html#a78c714939432311507baacc85de506e4">index</a> != rhs.<a class="code" href="structmui_1_1bin__iterator.html#a78c714939432311507baacc85de506e4">index</a>; }</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a12ed131569425fd91bd853eef3dd45ef">  139</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="structmui_1_1bin__iterator.html#a12ed131569425fd91bd853eef3dd45ef">operator==</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator</a>&amp; rhs )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(this-&gt;<a class="code" href="structmui_1_1bin__iterator.html#abb2f0a6ce3579fa7f33409da0b295ea1">operator!=</a>(rhs)); }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">P</a>&amp; <a class="code" href="structmui_1_1bin__iterator.html#a03e75c57f1b080531ea1da1ad7dc8039">operator*</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">P</a>* <a class="code" href="structmui_1_1bin__iterator.html#a4bf91868a5ca5e0cca146a11ad1ac24b">operator-&gt;</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a371e739fe4b63c447a787572eb8ed055">  144</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__range.html">bin_range&lt;T,CONFIG&gt;</a>&amp; <a class="code" href="structmui_1_1bin__iterator.html#a371e739fe4b63c447a787572eb8ed055">range</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a97ebdd9e81da980a9a455eef380ebf6f">  145</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structmui_1_1bin__iterator.html#a97ebdd9e81da980a9a455eef380ebf6f">count</a>[<a class="code" href="structmui_1_1bin__iterator.html#acb6d849efa422c9c07a5866c3031a3f8">D</a>-1];</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#ac6914757b751e94ba6763d82faabbc2c">  146</a></span>&#160;    std::size_t <a class="code" href="structmui_1_1bin__iterator.html#ac6914757b751e94ba6763d82faabbc2c">high</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a78c714939432311507baacc85de506e4">  147</a></span>&#160;    std::size_t <a class="code" href="structmui_1_1bin__iterator.html#a78c714939432311507baacc85de506e4">index</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;};</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">struct </span><a class="code" href="structmui_1_1bin__range.html">bin_range</a> {</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#af4a922fdb02454e89adce8ea9bb21f35">  152</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structmui_1_1bin__range.html#af4a922fdb02454e89adce8ea9bb21f35">P</a> = std::pair&lt;typename CONFIG::point_type,T&gt;;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#a808a42cd40f43cf33068640f6b86bf27">  153</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmui_1_1bin__range.html#a808a42cd40f43cf33068640f6b86bf27">D</a> = CONFIG::D;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#ad39d02903689c0911cffe91dc8634297">  154</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structmui_1_1bin__iterator.html">iterator</a> = <a class="code" href="structmui_1_1bin__iterator.html">bin_iterator&lt;T,CONFIG&gt;</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#a88d3f67ab1057072e6e9baa8cc153951">  155</a></span>&#160;    <a class="code" href="structmui_1_1bin__iterator.html">iterator</a> <a class="code" href="structmui_1_1bin__range.html#a88d3f67ab1057072e6e9baa8cc153951">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structmui_1_1bin__range.html#ad39d02903689c0911cffe91dc8634297">iterator</a>(*<span class="keyword">this</span>); }</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#aa495ff09ee344767ed68234edbaa6b9c">  156</a></span>&#160;    <a class="code" href="structmui_1_1bin__iterator.html">iterator</a> <a class="code" href="structmui_1_1bin__range.html#aa495ff09ee344767ed68234edbaa6b9c">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structmui_1_1bin__range.html#ad39d02903689c0911cffe91dc8634297">iterator</a>(*<span class="keyword">this</span>,0); }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    </div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#a9e41a34fe6f381f3c02d216dd66efe24">  158</a></span>&#160;    <a class="code" href="structmui_1_1bin__range.html#a9e41a34fe6f381f3c02d216dd66efe24">bin_range</a>( <span class="keywordtype">int</span> lda_[], <span class="keywordtype">int</span> lh_[][2], <span class="keyword">const</span> std::vector&lt;std::size_t&gt;&amp; d_, <span class="keyword">const</span> std::vector&lt;P&gt;&amp; v_ )</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        : <a class="code" href="structmui_1_1bin__range.html#a03f6cc1480f9233acea769dc0bfe26e9">displs</a>(d_), <a class="code" href="structmui_1_1bin__range.html#aaebd096de3e37d0c13fd27722d3fbb5e">value</a>(v_) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="structmui_1_1bin__range.html#a808a42cd40f43cf33068640f6b86bf27">D</a>; ++i ){</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="structmui_1_1bin__range.html#a78d3c699b3a7844bcf57007f6133eabf">lda</a>[i] = lda_[i];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="structmui_1_1bin__range.html#a5bb17a3c008ee08377fb19edefec8227">lh</a>[i][0] = lh_[i][0];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="structmui_1_1bin__range.html#a5bb17a3c008ee08377fb19edefec8227">lh</a>[i][1] = lh_[i][1];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="structmui_1_1bin__range.html#a9e41a34fe6f381f3c02d216dd66efe24">bin_range</a>(<span class="keyword">const</span> <a class="code" href="structmui_1_1bin__range.html">bin_range</a>&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="structmui_1_1bin__range.html">bin_range</a>&amp; <a class="code" href="structmui_1_1bin__range.html#ad35f0c7c78571e7247cff2b4a381529e">operator=</a>(<span class="keyword">const</span> <a class="code" href="structmui_1_1bin__range.html">bin_range</a>&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#a78d3c699b3a7844bcf57007f6133eabf">  169</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structmui_1_1bin__range.html#a78d3c699b3a7844bcf57007f6133eabf">lda</a>[<a class="code" href="structmui_1_1bin__range.html#a808a42cd40f43cf33068640f6b86bf27">D</a>];</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#a5bb17a3c008ee08377fb19edefec8227">  170</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structmui_1_1bin__range.html#a5bb17a3c008ee08377fb19edefec8227">lh</a>[<a class="code" href="structmui_1_1bin__range.html#a808a42cd40f43cf33068640f6b86bf27">D</a>][2];</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#a03f6cc1480f9233acea769dc0bfe26e9">  171</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::size_t&gt;&amp; <a class="code" href="structmui_1_1bin__range.html#a03f6cc1480f9233acea769dc0bfe26e9">displs</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structmui_1_1bin__range.html#aaebd096de3e37d0c13fd27722d3fbb5e">  172</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;P&gt;&amp; <a class="code" href="structmui_1_1bin__range.html#aaebd096de3e37d0c13fd27722d3fbb5e">value</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;};</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#ad4a934e39ea52abb9b9df227826e784b">  176</a></span>&#160;<a class="code" href="structmui_1_1bin__iterator.html#ad4a934e39ea52abb9b9df227826e784b">bin_iterator&lt;T,CONFIG&gt;::bin_iterator</a>( <span class="keyword">const</span> <a class="code" href="structmui_1_1bin__range.html">bin_range&lt;T,CONFIG&gt;</a>&amp; range_ ): range(range_)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="structmui_1_1bin__iterator.html#acb6d849efa422c9c07a5866c3031a3f8">D</a>-1; ++i ) <a class="code" href="structmui_1_1bin__iterator.html#a97ebdd9e81da980a9a455eef380ebf6f">count</a>[i] = <a class="code" href="structmui_1_1bin__iterator.html#a371e739fe4b63c447a787572eb8ed055">range</a>.lh[i+1][0];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="structmui_1_1bin__iterator.html#add20c0285e60fb2bd9e7b82bb9fb4204">validate</a>();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#abcbb2de1b131606af75b303f2d8e90e9">  182</a></span>&#160;<a class="code" href="structmui_1_1bin__iterator.html">bin_iterator&lt;T,CONFIG&gt;</a>&amp; <a class="code" href="structmui_1_1bin__iterator.html#abcbb2de1b131606af75b303f2d8e90e9">bin_iterator&lt;T,CONFIG&gt;::operator++</a>() </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>( ++index == high ){</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">for</span>( ; i&lt;D-2; ++i ){</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">if</span>( ++count[i] != range.lh[i+1][1] ) <span class="keywordflow">goto</span> VALIDATE;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            count[i] = range.lh[i+1][0];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        ++count[i];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    VALIDATE:</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        validate();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a9dd12ec01e52a6aac8a2aa511b4a0849">  197</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmui_1_1bin__iterator.html#a9dd12ec01e52a6aac8a2aa511b4a0849">bin_iterator&lt;T,CONFIG&gt;::invalidate</a>()</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{ </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    std::size_t offset = 0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;D-1; ++i ) offset += range.lda[i+1]*(range.lh[i+1][1]-1);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    index = high  = range.displs[offset+range.lh[0][1]];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#add20c0285e60fb2bd9e7b82bb9fb4204">  204</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structmui_1_1bin__iterator.html#add20c0285e60fb2bd9e7b82bb9fb4204">bin_iterator&lt;T,CONFIG&gt;::validate</a>()</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span>( count[D-2] == range.lh[D-1][1] ) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::size_t offset = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;D-1; ++i ) offset += range.lda[i+1]*count[i];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    index = range.displs[offset+range.lh[0][0]];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    high  = range.displs[offset+range.lh[0][1]];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a03e75c57f1b080531ea1da1ad7dc8039">  214</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">bin_iterator&lt;T,CONFIG&gt;::P</a>&amp; <a class="code" href="structmui_1_1bin__iterator.html#a03e75c57f1b080531ea1da1ad7dc8039">bin_iterator&lt;T,CONFIG&gt;::operator*</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> range.value[index]; }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="structmui_1_1bin__iterator.html#a4bf91868a5ca5e0cca146a11ad1ac24b">  216</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">bin_iterator&lt;T,CONFIG&gt;::P</a>* <a class="code" href="structmui_1_1bin__iterator.html#a4bf91868a5ca5e0cca146a11ad1ac24b">bin_iterator&lt;T,CONFIG&gt;::operator-&gt;</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> std::addressof(range.value[index]); }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> CONFIG&gt;</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structmui_1_1bin__t.html">  220</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmui_1_1bin__t.html">bin_t</a> {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">using</span> point_type = <span class="keyword">typename</span> CONFIG::point_type;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> D = CONFIG::D;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> QUIET = CONFIG::QUIET;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    std::vector&lt;std::size_t&gt; displs;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// sorted[displs[i]] is the first element of the i-th bin</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    point_type min, max;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    std::size_t n[CONFIG::D];</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keyword">typename</span> CONFIG::REAL h;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">using</span> REAL = <span class="keyword">typename</span> CONFIG::REAL;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structmui_1_1bin__t.html#a7b3d0531b0b1e7e96d2140366af04ad9">  235</a></span>&#160;    <a class="code" href="structmui_1_1bin__t.html#a7b3d0531b0b1e7e96d2140366af04ad9">bin_t</a>( std::vector&lt;std::pair&lt;point_type,T&gt; &gt;&amp; val ){</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span>( val.empty() ){</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            displs.resize(2,0);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            h = 1.0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// calculate h &amp; n</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        min = <a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a> = val[0].first;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">for</span>( std::size_t i=1; i&lt;val.size(); ++i ){</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            point_type p = val[i].first;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">for</span>( std::size_t i=0; i&lt;D; ++i ) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                min[i] = <a class="code" href="namespacemui_1_1dim.html#a4a9165384ff5faa33438dbd45aa99350">std::min</a>(min[i],p[i]);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a>[i] = <a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">std::max</a>(<a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a>[i],p[i]);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordtype">size_t</span> zero_count=0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        REAL vol = abs(<a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a>[0]-min[0]);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespacemui.html#a2e00c62074bb5b841ee769fdaca679a0">almost_equal</a>(vol, <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(0))) { <span class="comment">// check if first dimension is zero size, if so set to 1</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            vol = 1.0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            zero_count++;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        REAL vol_multi = vol;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=1; i&lt;D; ++i ){</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            vol_multi = <a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a>[i]-min[i];</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacemui.html#a2e00c62074bb5b841ee769fdaca679a0">almost_equal</a>(vol_multi, <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(0))) { <span class="comment">// check if other dimensions are zero size, if so set them to 1</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                vol_multi = <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(1);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                zero_count++;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            vol *= vol_multi;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (zero_count == D) <span class="comment">// if each dimension was actually zero (rather than just a subset) then set vol to zero</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            vol = <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        h = std::pow(<span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(6)*vol/<span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(val.size()),1.0/D); <span class="comment">// about 6 points per bin</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespacemui.html#a2e00c62074bb5b841ee769fdaca679a0">almost_equal</a>(h, <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(0))){ <span class="comment">// if h is still zero (only in the case of all dimensions being zero) then warn the user as this may be a problem</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            h = <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(1); <span class="comment">// in this special case set h to 1 arbitrarily so bins work numerically</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">if</span>(val.size() &gt; 1 &amp;&amp; !QUIET)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;MUI Warning [bin.h]: Bin support size fixed to 1.0, check interface dimensionality or problem decomposition.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        std::size_t nn=1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;D; ++i ) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            n[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(std::ceil((<a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a>[i]-min[i])/h));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            n[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">std::max</a>( n[i], std::size_t(1) ));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            nn *= n[i];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// make index</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        std::vector&lt;std::size_t&gt; index(val.size()+1,0);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        std::vector&lt;std::size_t&gt; counts(nn,0);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">for</span>( std::size_t i=0; i&lt;val.size(); ++i ) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            index[i] = get_index_(val[i].first);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            ++counts[index[i]];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        displs.resize(nn+1,0); <span class="comment">// add 1 for sentinel</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        std::partial_sum(counts.begin(),counts.end(), displs.begin()+1);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        counts = displs;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        std::vector&lt;std::pair&lt;point_type,T&gt; &gt; v(val.size());</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">for</span>( std::size_t i=0; i&lt;val.size(); ++i ) v[counts[index[i]]++] = val[i];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        v.swap(val);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="structmui_1_1bin__t.html#a91b139f0c12749291bc477f18b540529">  303</a></span>&#160;    std::vector&lt;std::size_t&gt; <a class="code" href="structmui_1_1bin__t.html#a91b139f0c12749291bc477f18b540529">query</a>( <span class="keyword">const</span> <a class="code" href="classmui_1_1geometry_1_1box.html">geometry::box&lt;CONFIG&gt;</a>&amp; bx )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        std::vector&lt;std::size_t&gt; map;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordtype">int</span> lda[D];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordtype">int</span> lh[D][2];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span>( initialize_query_(bx,lda,lh) ) <span class="keywordflow">return</span> map;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        map.reserve(lda[D-1]*12);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="namespacemui.html#af94c98a0248d6923c8681b4d2c39df6e">set_map_&lt;D-1&gt;::apply</a>( 0, lda, lh, displs, map );</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        map.shrink_to_fit();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">return</span> map;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="structmui_1_1bin__t.html#abda7b56b8f16c788edef7ffa446945b9">  315</a></span>&#160;    <a class="code" href="structmui_1_1bin__range.html">bin_range&lt;T,CONFIG&gt;</a> <a class="code" href="structmui_1_1bin__t.html#abda7b56b8f16c788edef7ffa446945b9">query2</a>( <span class="keyword">const</span> <a class="code" href="classmui_1_1geometry_1_1box.html">geometry::box&lt;CONFIG&gt;</a>&amp; bx, <span class="keyword">const</span> std::vector&lt;std::pair&lt;point_type,T&gt; &gt;&amp; v )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordtype">int</span> lda[D];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordtype">int</span> lh[D][2];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        initialize_query_(bx,lda,lh);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structmui_1_1bin__range.html">bin_range&lt;T,CONFIG&gt;</a>{lda,lh,displs,v};</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="structmui_1_1bin__t.html#a10d7dcbebbd3e27e9b14c53657a58194">  322</a></span>&#160;    REAL <a class="code" href="structmui_1_1bin__t.html#a10d7dcbebbd3e27e9b14c53657a58194">domain_size</a>() {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        REAL dim_size = <a class="code" href="namespacemui.html#afc24552d3db09a672443b14f96b2b8aa">norm</a>(<a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">max</a>-min);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">// Special case if domain only contains a single point</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespacemui.html#a2e00c62074bb5b841ee769fdaca679a0">almost_equal</a>(dim_size, <span class="keyword">static_cast&lt;</span>REAL<span class="keyword">&gt;</span>(0)))</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            dim_size = 1.0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">return</span> dim_size;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">bool</span> initialize_query_( <span class="keyword">const</span> <a class="code" href="classmui_1_1geometry_1_1box.html">geometry::box&lt;CONFIG&gt;</a>&amp; bx, <span class="keywordtype">int</span> lda[], <span class="keywordtype">int</span> lh[][2] )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordtype">bool</span> broken = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        lda[0] = 1;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=1; i&lt;CONFIG::D; ++i ) lda[i] = lda[i-1]*n[i-1];</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;CONFIG::D; ++i ) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            lh[i][0] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">std::max</a>(std::floor((bx.<a class="code" href="classmui_1_1geometry_1_1box.html#a548b6ae064a454c01d23052105bd62f4">get_min</a>()[i]-min[i])/h),<span class="keyword">typename</span> CONFIG::REAL(0)));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            lh[i][1] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacemui_1_1dim.html#a4a9165384ff5faa33438dbd45aa99350">std::min</a>(std::ceil((bx.<a class="code" href="classmui_1_1geometry_1_1box.html#aac50a654e0e82789ba447ac9d360959d">get_max</a>()[i]-min[i])/h),<span class="keyword">typename</span> CONFIG::REAL(n[i])));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">if</span>( lh[i][0] &gt;= lh[i][1] ){</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                lh[i][0] = lh[i][1];</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                broken = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">return</span> broken;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keyword">inline</span> std::size_t get_index_( <span class="keyword">const</span> point_type&amp; pt )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        std::size_t <a class="code" href="namespacemui_1_1dim.html#a712aced9b0e9ae81c112b61d1776f5fa">m</a> = 1, ret=0;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;D; ++i ) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            std::size_t d = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((std::floor((pt[i]-min[i])/h)));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            d = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="namespacemui_1_1dim.html#a4a9165384ff5faa33438dbd45aa99350">std::min</a>(d,n[i]-1)); <span class="comment">// the values may change here if (max[i]-min[i])/h is equal to a integer value.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            ret += <a class="code" href="namespacemui_1_1dim.html#a712aced9b0e9ae81c112b61d1776f5fa">m</a>*d;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <a class="code" href="namespacemui_1_1dim.html#a712aced9b0e9ae81c112b61d1776f5fa">m</a> *= n[i];</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;};</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructmui_1_1bin__range_html_a808a42cd40f43cf33068640f6b86bf27"><div class="ttname"><a href="structmui_1_1bin__range.html#a808a42cd40f43cf33068640f6b86bf27">mui::bin_range::D</a></div><div class="ttdeci">static const int D</div><div class="ttdef"><b>Definition:</b> bin.h:153</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_a5bb17a3c008ee08377fb19edefec8227"><div class="ttname"><a href="structmui_1_1bin__range.html#a5bb17a3c008ee08377fb19edefec8227">mui::bin_range::lh</a></div><div class="ttdeci">int lh[D][2]</div><div class="ttdef"><b>Definition:</b> bin.h:170</div></div>
<div class="ttc" id="anamespacemui_html_af94c98a0248d6923c8681b4d2c39df6e"><div class="ttname"><a href="namespacemui.html#af94c98a0248d6923c8681b4d2c39df6e">mui::apply</a></div><div class="ttdeci">vexpr_apply1&lt; E, OP, SCALAR, D &gt; apply(vexpr&lt; E, SCALAR, D &gt; const &amp;u, OP const &amp;op)</div><div class="ttdef"><b>Definition:</b> point.h:392</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_abcbb2de1b131606af75b303f2d8e90e9"><div class="ttname"><a href="structmui_1_1bin__iterator.html#abcbb2de1b131606af75b303f2d8e90e9">mui::bin_iterator::operator++</a></div><div class="ttdeci">bin_iterator &amp; operator++()</div><div class="ttdef"><b>Definition:</b> bin.h:182</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a4bf91868a5ca5e0cca146a11ad1ac24b"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a4bf91868a5ca5e0cca146a11ad1ac24b">mui::bin_iterator::operator-&gt;</a></div><div class="ttdeci">const P * operator-&gt;() const</div><div class="ttdef"><b>Definition:</b> bin.h:216</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html"><div class="ttname"><a href="structmui_1_1bin__iterator.html">mui::bin_iterator</a></div><div class="ttdef"><b>Definition:</b> bin.h:121</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a97ebdd9e81da980a9a455eef380ebf6f"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a97ebdd9e81da980a9a455eef380ebf6f">mui::bin_iterator::count</a></div><div class="ttdeci">int count[D-1]</div><div class="ttdef"><b>Definition:</b> bin.h:145</div></div>
<div class="ttc" id="aclassmui_1_1geometry_1_1box_html_aac50a654e0e82789ba447ac9d360959d"><div class="ttname"><a href="classmui_1_1geometry_1_1box.html#aac50a654e0e82789ba447ac9d360959d">mui::geometry::box::get_max</a></div><div class="ttdeci">coordinate_type get_max() const</div><div class="ttdef"><b>Definition:</b> geometry.h:204</div></div>
<div class="ttc" id="ageometry_8h_html"><div class="ttname"><a href="geometry_8h.html">geometry.h</a></div><div class="ttdoc">Base classes for creating geometries, primarily used by spatial interpolation methods and for definin...</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_a9e41a34fe6f381f3c02d216dd66efe24"><div class="ttname"><a href="structmui_1_1bin__range.html#a9e41a34fe6f381f3c02d216dd66efe24">mui::bin_range::bin_range</a></div><div class="ttdeci">bin_range(int lda_[], int lh_[][2], const std::vector&lt; std::size_t &gt; &amp;d_, const std::vector&lt; P &gt; &amp;v_)</div><div class="ttdef"><b>Definition:</b> bin.h:158</div></div>
<div class="ttc" id="anamespacemui_1_1dim_html_a4a9165384ff5faa33438dbd45aa99350"><div class="ttname"><a href="namespacemui_1_1dim.html#a4a9165384ff5faa33438dbd45aa99350">mui::dim::min</a></div><div class="ttdeci">u u u u u u min</div><div class="ttdef"><b>Definition:</b> dim.h:289</div></div>
<div class="ttc" id="anamespacemui_html_ab78e75f496c4d793c673081f344d5fc6"><div class="ttname"><a href="namespacemui.html#ab78e75f496c4d793c673081f344d5fc6">mui::operator*</a></div><div class="ttdeci">vexpr_mul&lt; E1, E2, SCALAR, D &gt; operator*(vexpr&lt; E1, SCALAR, D &gt; const &amp;u, vexpr&lt; E2, SCALAR, D &gt; const &amp;v)</div><div class="ttdef"><b>Definition:</b> point.h:300</div></div>
<div class="ttc" id="anamespacemui_html_a8f282990f9dab2d809dc062d6142e212"><div class="ttname"><a href="namespacemui.html#a8f282990f9dab2d809dc062d6142e212">mui::operator+</a></div><div class="ttdeci">vexpr_add&lt; E1, E2, SCALAR, D &gt; operator+(vexpr&lt; E1, SCALAR, D &gt; const &amp;u, vexpr&lt; E2, SCALAR, D &gt; const &amp;v)</div><div class="ttdef"><b>Definition:</b> point.h:285</div></div>
<div class="ttc" id="astructmui_1_1bin__t_html_a91b139f0c12749291bc477f18b540529"><div class="ttname"><a href="structmui_1_1bin__t.html#a91b139f0c12749291bc477f18b540529">mui::bin_t::query</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; query(const geometry::box&lt; CONFIG &gt; &amp;bx) const</div><div class="ttdef"><b>Definition:</b> bin.h:303</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_ac6914757b751e94ba6763d82faabbc2c"><div class="ttname"><a href="structmui_1_1bin__iterator.html#ac6914757b751e94ba6763d82faabbc2c">mui::bin_iterator::high</a></div><div class="ttdeci">std::size_t high</div><div class="ttdef"><b>Definition:</b> bin.h:146</div></div>
<div class="ttc" id="anamespacemui_html_a2e00c62074bb5b841ee769fdaca679a0"><div class="ttname"><a href="namespacemui.html#a2e00c62074bb5b841ee769fdaca679a0">mui::almost_equal</a></div><div class="ttdeci">bool almost_equal(T x, T y)</div><div class="ttdef"><b>Definition:</b> util.h:128</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a03e75c57f1b080531ea1da1ad7dc8039"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a03e75c57f1b080531ea1da1ad7dc8039">mui::bin_iterator::operator*</a></div><div class="ttdeci">const P &amp; operator*() const</div><div class="ttdef"><b>Definition:</b> bin.h:214</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_a78d3c699b3a7844bcf57007f6133eabf"><div class="ttname"><a href="structmui_1_1bin__range.html#a78d3c699b3a7844bcf57007f6133eabf">mui::bin_range::lda</a></div><div class="ttdeci">int lda[D]</div><div class="ttdef"><b>Definition:</b> bin.h:169</div></div>
<div class="ttc" id="anamespacemui_html_afc24552d3db09a672443b14f96b2b8aa"><div class="ttname"><a href="namespacemui.html#afc24552d3db09a672443b14f96b2b8aa">mui::norm</a></div><div class="ttdeci">SCALAR norm(vexpr&lt; E, SCALAR, D &gt; const &amp;u)</div><div class="ttdef"><b>Definition:</b> point.h:386</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_add20c0285e60fb2bd9e7b82bb9fb4204"><div class="ttname"><a href="structmui_1_1bin__iterator.html#add20c0285e60fb2bd9e7b82bb9fb4204">mui::bin_iterator::validate</a></div><div class="ttdeci">void validate()</div><div class="ttdef"><b>Definition:</b> bin.h:204</div></div>
<div class="ttc" id="aclassmui_1_1geometry_1_1box_html"><div class="ttname"><a href="classmui_1_1geometry_1_1box.html">mui::geometry::box</a></div><div class="ttdef"><b>Definition:</b> geometry.h:70</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_a88d3f67ab1057072e6e9baa8cc153951"><div class="ttname"><a href="structmui_1_1bin__range.html#a88d3f67ab1057072e6e9baa8cc153951">mui::bin_range::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> bin.h:155</div></div>
<div class="ttc" id="anamespacemui_html_a6abe0b4248d7b1594551ff4f6ddda20a"><div class="ttname"><a href="namespacemui.html#a6abe0b4248d7b1594551ff4f6ddda20a">mui::operator-</a></div><div class="ttdeci">vexpr_sub&lt; E1, E2, SCALAR, D &gt; operator-(vexpr&lt; E1, SCALAR, D &gt; const &amp;u, vexpr&lt; E2, SCALAR, D &gt; const &amp;v)</div><div class="ttdef"><b>Definition:</b> point.h:290</div></div>
<div class="ttc" id="abin_8h_html_adaedeb4494f60b41fe2e306a04764402"><div class="ttname"><a href="bin_8h.html#adaedeb4494f60b41fe2e306a04764402">cur_</a></div><div class="ttdeci">INT cur_</div><div class="ttdef"><b>Definition:</b> bin.h:59</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a28e68216dd247d68b9c60f99c13631c5"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a28e68216dd247d68b9c60f99c13631c5">mui::bin_iterator::bin_iterator</a></div><div class="ttdeci">bin_iterator(const bin_range&lt; T, CONFIG &gt; &amp;range_, int)</div><div class="ttdef"><b>Definition:</b> bin.h:125</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_aa495ff09ee344767ed68234edbaa6b9c"><div class="ttname"><a href="structmui_1_1bin__range.html#aa495ff09ee344767ed68234edbaa6b9c">mui::bin_range::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> bin.h:156</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_ad39d02903689c0911cffe91dc8634297"><div class="ttname"><a href="structmui_1_1bin__range.html#ad39d02903689c0911cffe91dc8634297">mui::bin_range::iterator</a></div><div class="ttdeci">bin_iterator&lt; T, CONFIG &gt; iterator</div><div class="ttdef"><b>Definition:</b> bin.h:154</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a4d77cf5d472236ac4d8a35bb97d70011"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a4d77cf5d472236ac4d8a35bb97d70011">mui::bin_iterator::operator=</a></div><div class="ttdeci">bin_iterator &amp; operator=(const bin_iterator &amp;)=default</div></div>
<div class="ttc" id="anamespacemui_1_1dim_html_a712aced9b0e9ae81c112b61d1776f5fa"><div class="ttname"><a href="namespacemui_1_1dim.html#a712aced9b0e9ae81c112b61d1776f5fa">mui::dim::m</a></div><div class="ttdeci">u u m</div><div class="ttdef"><b>Definition:</b> dim.h:281</div></div>
<div class="ttc" id="astructmui_1_1bin__t_html_a10d7dcbebbd3e27e9b14c53657a58194"><div class="ttname"><a href="structmui_1_1bin__t.html#a10d7dcbebbd3e27e9b14c53657a58194">mui::bin_t::domain_size</a></div><div class="ttdeci">REAL domain_size()</div><div class="ttdef"><b>Definition:</b> bin.h:322</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_acb6d849efa422c9c07a5866c3031a3f8"><div class="ttname"><a href="structmui_1_1bin__iterator.html#acb6d849efa422c9c07a5866c3031a3f8">mui::bin_iterator::D</a></div><div class="ttdeci">static const int D</div><div class="ttdef"><b>Definition:</b> bin.h:123</div></div>
<div class="ttc" id="anamespacemui_html_aca8bb75431ac5c48173731e02a5c6246"><div class="ttname"><a href="namespacemui.html#aca8bb75431ac5c48173731e02a5c6246">mui::max</a></div><div class="ttdeci">SCALAR max(vexpr&lt; E, SCALAR, D &gt; const &amp;u)</div><div class="ttdef"><b>Definition:</b> point.h:350</div></div>
<div class="ttc" id="aclassmui_1_1geometry_1_1box_html_a548b6ae064a454c01d23052105bd62f4"><div class="ttname"><a href="classmui_1_1geometry_1_1box.html#a548b6ae064a454c01d23052105bd62f4">mui::geometry::box::get_min</a></div><div class="ttdeci">coordinate_type get_min() const</div><div class="ttdef"><b>Definition:</b> geometry.h:202</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_ad35f0c7c78571e7247cff2b4a381529e"><div class="ttname"><a href="structmui_1_1bin__range.html#ad35f0c7c78571e7247cff2b4a381529e">mui::bin_range::operator=</a></div><div class="ttdeci">bin_range &amp; operator=(const bin_range &amp;)=default</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a9dd12ec01e52a6aac8a2aa511b4a0849"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a9dd12ec01e52a6aac8a2aa511b4a0849">mui::bin_iterator::invalidate</a></div><div class="ttdeci">void invalidate()</div><div class="ttdef"><b>Definition:</b> bin.h:197</div></div>
<div class="ttc" id="astructmui_1_1bin__t_html_a7b3d0531b0b1e7e96d2140366af04ad9"><div class="ttname"><a href="structmui_1_1bin__t.html#a7b3d0531b0b1e7e96d2140366af04ad9">mui::bin_t::bin_t</a></div><div class="ttdeci">bin_t(std::vector&lt; std::pair&lt; point_type, T &gt; &gt; &amp;val)</div><div class="ttdef"><b>Definition:</b> bin.h:235</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a348e1d15c037b9e1302f16dc065928fb"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a348e1d15c037b9e1302f16dc065928fb">mui::bin_iterator::operator++</a></div><div class="ttdeci">bin_iterator operator++(int)</div><div class="ttdef"><b>Definition:</b> bin.h:130</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a371e739fe4b63c447a787572eb8ed055"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a371e739fe4b63c447a787572eb8ed055">mui::bin_iterator::range</a></div><div class="ttdeci">const bin_range&lt; T, CONFIG &gt; &amp; range</div><div class="ttdef"><b>Definition:</b> bin.h:144</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a647b888410c7aec82b750400f5d5c283"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a647b888410c7aec82b750400f5d5c283">mui::bin_iterator::P</a></div><div class="ttdeci">std::pair&lt; typename CONFIG::point_type, T &gt; P</div><div class="ttdef"><b>Definition:</b> bin.h:122</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_abb2f0a6ce3579fa7f33409da0b295ea1"><div class="ttname"><a href="structmui_1_1bin__iterator.html#abb2f0a6ce3579fa7f33409da0b295ea1">mui::bin_iterator::operator!=</a></div><div class="ttdeci">bool operator!=(const bin_iterator &amp;rhs) const</div><div class="ttdef"><b>Definition:</b> bin.h:138</div></div>
<div class="ttc" id="anamespacemui_html"><div class="ttname"><a href="namespacemui.html">mui</a></div><div class="ttdef"><b>Definition:</b> bin.h:54</div></div>
<div class="ttc" id="astructmui_1_1bin__t_html"><div class="ttname"><a href="structmui_1_1bin__t.html">mui::bin_t</a></div><div class="ttdef"><b>Definition:</b> bin.h:220</div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div><div class="ttdoc">File containing data structures defining all data types used by an interface.</div></div>
<div class="ttc" id="astructmui_1_1bin__t_html_abda7b56b8f16c788edef7ffa446945b9"><div class="ttname"><a href="structmui_1_1bin__t.html#abda7b56b8f16c788edef7ffa446945b9">mui::bin_t::query2</a></div><div class="ttdeci">bin_range&lt; T, CONFIG &gt; query2(const geometry::box&lt; CONFIG &gt; &amp;bx, const std::vector&lt; std::pair&lt; point_type, T &gt; &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> bin.h:315</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a78c714939432311507baacc85de506e4"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a78c714939432311507baacc85de506e4">mui::bin_iterator::index</a></div><div class="ttdeci">std::size_t index</div><div class="ttdef"><b>Definition:</b> bin.h:147</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html"><div class="ttname"><a href="structmui_1_1bin__range.html">mui::bin_range</a></div><div class="ttdef"><b>Definition:</b> bin.h:118</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_a03f6cc1480f9233acea769dc0bfe26e9"><div class="ttname"><a href="structmui_1_1bin__range.html#a03f6cc1480f9233acea769dc0bfe26e9">mui::bin_range::displs</a></div><div class="ttdeci">const std::vector&lt; std::size_t &gt; &amp; displs</div><div class="ttdef"><b>Definition:</b> bin.h:171</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_aaebd096de3e37d0c13fd27722d3fbb5e"><div class="ttname"><a href="structmui_1_1bin__range.html#aaebd096de3e37d0c13fd27722d3fbb5e">mui::bin_range::value</a></div><div class="ttdeci">const std::vector&lt; P &gt; &amp; value</div><div class="ttdef"><b>Definition:</b> bin.h:172</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_ad4a934e39ea52abb9b9df227826e784b"><div class="ttname"><a href="structmui_1_1bin__iterator.html#ad4a934e39ea52abb9b9df227826e784b">mui::bin_iterator::bin_iterator</a></div><div class="ttdeci">bin_iterator(const bin_range&lt; T, CONFIG &gt; &amp;range_)</div><div class="ttdef"><b>Definition:</b> bin.h:176</div></div>
<div class="ttc" id="astructmui_1_1bin__range_html_af4a922fdb02454e89adce8ea9bb21f35"><div class="ttname"><a href="structmui_1_1bin__range.html#af4a922fdb02454e89adce8ea9bb21f35">mui::bin_range::P</a></div><div class="ttdeci">std::pair&lt; typename CONFIG::point_type, T &gt; P</div><div class="ttdef"><b>Definition:</b> bin.h:152</div></div>
<div class="ttc" id="astructmui_1_1bin__iterator_html_a12ed131569425fd91bd853eef3dd45ef"><div class="ttname"><a href="structmui_1_1bin__iterator.html#a12ed131569425fd91bd853eef3dd45ef">mui::bin_iterator::operator==</a></div><div class="ttdeci">bool operator==(const bin_iterator &amp;rhs) const</div><div class="ttdef"><b>Definition:</b> bin.h:139</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="bin_8h.html">bin.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
