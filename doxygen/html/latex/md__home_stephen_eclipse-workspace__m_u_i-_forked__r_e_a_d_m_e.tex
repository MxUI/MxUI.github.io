Concurrently coupled numerical simulations using heterogeneous solvers are powerful tools for modeling both multiscale and multiphysics phenomena. However, major modifications to existing codes are often required to enable such simulations, posing significant difficulties in practice. Here we present the Multiscale Universal Interface (M\+UI), which is capable of facilitating the coupling effort for a wide range of simulation types.

The library adopts a header-\/only form with minimal external dependency and hence can be easily dropped into existing codes. A data sampler concept is introduced, combined with a hybrid dynamic/static typing mechanism, to create an easily customizable framework for solver-\/independent data interpretation.

The library integrates M\+PI M\+P\+MD support and an asynchronous communication protocol to handle inter-\/solver information exchange irrespective of the solversâ€™ own M\+PI awareness. Template metaprogramming is heavily employed to simultaneously improve runtime performance and code flexibility.

In the publication referenced below, the library is validated by solving three different multiscale type problems, which also serve to demonstrate the flexibility of the framework in handling heterogeneous models and solvers associated with multiphysics problems. In the first example, a Couette flow was simulated using two concurrently coupled Smoothed Particle Hydrodynamics (S\+PH) simulations of different spatial resolutions. In the second example, we coupled the deterministic S\+PH method with the stochastic Dissipative Particle Dynamics (D\+PD) method to study the effect of surface grafting on the hydrodynamics properties on the surface. In the third example, we consider conjugate heat transfer between a solid domain and a fluid domain by coupling the particle-\/based energy-\/conserving D\+PD (e\+D\+PD) method with the Finite Element Method (F\+EM).

\doxysection*{Licensing}

The source code is dual-\/licensed under either the G\+NU General Purpose License v3 or Apache License v2.\+0.

\doxysection*{Installation}

M\+UI is a C++ header-\/only library with two dependencies -\/ an M\+PI implementation that supports the M\+P\+MD paradigm and the linear algebra library \href{https://gitlab.com/libeigen/eigen.git}{\texttt{ Eigen}}\textsuperscript{1}.

Wrappers are provided for C, Fortran and Python, these require compilation and therefore when using M\+UI with any of thee languages the library can no longer be considered header-\/only.

As a header-\/only library using M\+UI in your own source code is straight forward, there are two ways to utilise the library in this scenario\+:


\begin{DoxyEnumerate}
\item Include \char`\"{}mui.\+h\char`\"{} in your code and add appropriate paths to your compiler, if you wish to utilise a wrapper then go to the /wrappers folder and utilise the Makefile build system in each to generate compiled libraries to link against, any associated header files are also located here.
\item (preferred) Utilise the provided C\+Make build files to create a local or system-\/wide installation of the library. In this case there are a number of C\+Make parameters you should consider\+:
\begin{DoxyEnumerate}
\item C\+M\+A\+K\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+\_\+\+P\+R\+E\+F\+IX=\mbox{[}path\mbox{]} -\/ Set the path to install the library, otherwise the system default will be used
\item C\+M\+A\+K\+E\+\_\+\+B\+U\+I\+L\+D\+\_\+\+T\+Y\+PE=Release/\+Debug/.. -\/ Set the compilation type (only changes options for compiled wrappers)
\item U\+S\+E\+\_\+\+R\+BF=O\+N/\+O\+FF -\/ If set to ON then a dependency on Eigen is created
\item C\+\_\+\+W\+R\+A\+P\+P\+ER=O\+N/\+O\+FF -\/ Specifies whether to compile the C wrapper during installation
\item F\+O\+R\+T\+R\+A\+N\+\_\+\+W\+R\+A\+P\+P\+ER=O\+N/\+O\+FF -\/ Specifies whether to compile the Fortran wrapper during installation
\item P\+Y\+T\+H\+O\+N\+\_\+\+W\+R\+A\+P\+P\+ER=O\+N/\+O\+FF -\/ Specifies whether to compile the Python wrapper during installation, relies on a working Python3 toolchain
\item P\+I\+P\+\_\+\+I\+N\+S\+T\+A\+LL=O\+N/\+O\+FF -\/ Only applies if P\+Y\+T\+H\+O\+N\+\_\+\+W\+R\+A\+P\+P\+ER=ON, uses system default pip3 command
\end{DoxyEnumerate}
\end{DoxyEnumerate}

\textsuperscript{1} Only true if the Radial Basis Function (R\+BF) spatial interpolation scheme is included at compile-\/time.

\doxysection*{Publication}

{\bfseries{Tang}} Y.-\/H., {\bfseries{Kudo}}, S., {\bfseries{Bian}}, X., {\bfseries{Li}}, Z., \& {\bfseries{Karniadakis}}, G. E. Multiscale Universal Interface\+: A Concurrent Framework for Coupling Heterogeneous Solvers, {\itshape Journal of Computational Physics}, {\bfseries{2015}}, 297.\+15, 13-\/31.

\doxysection*{Contact}

Should you have any question please do not hesitate to contact the developers, a list can be found within the Mx\+UI \href{https://mxui.github.io/about.html}{\texttt{ about}} page.

\doxysection*{Examples}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Concurrently coupled simulation of conjugate heat transfer using Finite Element (F\+EM) -\/ Dissipative Particle Dynamics (D\+PD)  }\\\cline{1-1}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Concurrently coupled simulation of conjugate heat transfer using Finite Element (F\+EM) -\/ Dissipative Particle Dynamics (D\+PD)  }\\\cline{1-1}
\endhead
\PBS\centering   \\\cline{1-1}
\end{longtabu}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ D\+P\+D-\/\+S\+PH coupled simulation of flow past polymer-\/grafted surface  }\\\cline{1-1}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ D\+P\+D-\/\+S\+PH coupled simulation of flow past polymer-\/grafted surface  }\\\cline{1-1}
\endhead
\PBS\centering   \\\cline{1-1}
\end{longtabu}
